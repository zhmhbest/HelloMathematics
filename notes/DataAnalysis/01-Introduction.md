<link rel='stylesheet' href='../../style/index.css'>
<script src='../../style/index.js'></script>

# [绪论](./index.html)

[TOC]

## 数值分析的流程

```flow
block1=>operation: 实际问题
block2=>operation: 数学模型
block3=>operation: 数值计算方法
block4=>operation: 程序设计
block5=>operation: 计算机计算求出结果
<!--  -->
block1->block2->block3->block4->block5
```

## 误差

设数$x$是精确值$x^*$的一个近似值。

### 误差的来源

- **模型误差**：无法避免，数值分析不研究。
- **观测误差**：无法避免，数值分析不研究。
- **截断误差（方法误差）**：人为主观采用某种近似方法造成。
- **舍入误差（计算误差）**：计算机只能存放浮点数近似值造成。

### 绝对误差

**绝对误差**

$$e=|x^*-x|$$
称$e$为近似值$x$的**绝对误差**，简称**误差**。

**绝对误差限**

$$e≤ε(x)$$
称$ε(x)$为近似值$x$的**绝对误差限**，简称**误差限**。

**性质**

- $ε(x_1±x_2) = ε(x_1) + ε(x_2)$
- $ε(x_1x_2) = |x_1|ε(x_2) + |x_2|ε(x_1)$
- $ε(\dfrac{x_1}{x_2}) = \dfrac{|x_1|ε(x_2) + |x_2|ε(x_1)}{|x_2|^2}$

### 相对误差

**相对误差**

绝对误差有时并不能很好地反映近似程度的好坏。

$$e_r = \dfrac{e}{|x^*|} = |\dfrac{x^*-x}{x^*}|$$
称$e_r$为近似值$x$的**相对误差**。

在实际计算中，可以认为$x$是准确的，可将分母替换为$x$。故：

$$e_r = |\dfrac{x^*-x}{x}|$$

**相对误差限**

$$e_r≤ε_r(x)$$

称$ε_r(x)$为近似值$x$的**相对误差限**。

**性质**

- $ε_r(x_1x_2) = ε_r(x_1) + ε_r(x_2)$

#### 误差估计

由$f(x^*) - f(x) = f'(x)(x^*-x) + \dfrac{f''(ξ)}{2}(x^*-x)^2$，得$ε[f(x)] ≈ |f'(x)|ε(x)|$。

推理得

$$ε[f(x_1,\cdots,x_n)] ≈ \sum_{k=1}^{n} \left| \dfrac{∂f}{∂x_k} \right| ε(x_k)$$

### *Example*

#### 例1

设$x$和$y$的相对误差$ε_r=0.001$，则$x ⋅ y$的相对误差为多少。

$ε_r(xy) = ε_r(x) + ε_r(y) = 0.002$

#### 例2

设$x=1.24$是由精确值$x^*$经过四舍五入得到的近似值。

**问**

1. 绝对误差限$ε$是多少？
2. 相对误差限$ε_r$是多少？

**解**

- $1.235≤x^*<1.245$
- $⇒ ε=0.005$
- $⇒ ε_r=\dfrac{0.005}{1.24} ≈ 0.4%$

**结论**

凡是由精确值经过四舍五入得到的近似值，其**绝对误差限**等于该近似值末位的半个单位。

<!-- #### 例2

设$x$和$y$的相对误差为$0.001$，则$x ⋅ y$的相对误差为多少。

**解**

$e=|y-x|<ε$
$e_r = |\dfrac{y-x}{y}|$ -->

## 有效数字

如果$x$的**绝对误差限**$e$是它的某一数位的半个单位，并且从$x$左起第一个非零数字到该数位共有$n$位，则称这$n$个数字为$x$的有效数字，即$x$近似$x^*$时有$n$位有效数字。此外，我们认为精确值的有效数字有无穷多位。

### 标准浮点数

数$x$总可以写成
$$x=±0.a_1a_2{\dots}a_k×10^m$$

其中$a_1≠0$、$a_k∈[0, 9]$，该形式即称为**标准浮点数**。

### 有效数字和绝对误差限

>[当且仅当等价于充要条件](https://www.zhihu.com/question/28594040/answer/125495014)

$x$作为$x^*$的近似值，具有$n$位有效数字，当且仅当：
$$|x^*-x| = |e| ≤ \frac{1}{2}×10^{m-n}$$

- $m$：近似值$x$写成**标准浮点数**时的指数位置取值。
- $n$：近似值$x$取得的有效数字位数。

该方程反映了绝对误差$e$和有效位数$n$之间的关系。

### 有效数字和相对误差限

**求相对误差限**

若$x$有$n$位有效数字，则其相对误差限为：

$$ε_r = \frac{1}{2a_1}×10^{1-n}$$

- $a_1$：近似值$x$写成标准浮点数后，小数点后第一个非$0$数字。
- $n$：近似值$x$取得的有效数字位数。

**求有效数字**

若$x$的相对误差限满足：

$$ε_r = \frac{1}{2(a_1+1)}×10^{1-n}$$

则$x$至少有$n$位有效数字。

### *Example*

#### 例1

已知$π=3.1415926535897\cdots$，$x_i$是$π$的近似值。

$x_1=3.14159$

- $m=1$
- $e = |π-x| ≈ 0.265 × 10^{-5} ≤ \frac{1}{2}×10^{m-n} = \frac{1}{2}×10^{-5}$
- $x_1$有6位有效数字。

$x_2=3.142$

- $m=1$
- $e = |π-x| ≈ 0.407 × 10^{-3} < \frac{1}{2}×10^{m-n} = \frac{1}{2} × 10^{-3}$
- $x_2$有4位有效数字。

$x_3=3.1415$

- $m=1$
- $e = |π-x| ≈ 0.926 × 10^{-4} < \frac{1}{2}×10^{m-n} = \frac{1}{2} × 10^{-3}$
- $x_3$有4位有效数字。

#### 例2

使$x^*=\sqrt{2}$的近似值的绝对误差$e$小于$10^{-5}$。

**问**

1. 应取几位有效数字$n$？
2. 近似值$x$的取值为多少？

**解**

- $\sqrt{2} = 1.414{\cdots} = 0.141{\cdots}×10^1 ⇒ m = 1$
- 令$|\sqrt{2} - x| ≤ \dfrac{1}{2}×10^{1-n} = \dfrac{1}{2}×10^{-5}$
- 得$n=6$，$x=1.41421$。

#### 例3

$x=0.01458663$为真值$0.01451845$得近似，则$x$有几位有效数字。

- $x = 0.1458663 × 10^{-1}$
- $e = 0.00006818\cdots ≈ 0.6818 × 10^{-4} ≤ \frac{1}{2}×10^{m-n} = \frac{1}{2}×10^{-3}$
- $n=2$

## 数值稳定性

**数值稳定性**，即，计算过程中，舍入误差不增长。

**数值计算若干原则**

1. 避免两个相近的数相减（会造成有效数字丢失）
2. 防止大数吃掉小数
3. 绝对值过小的数不宜做除数
4. 简化计算程序，减少计算次数
5. 选用数值稳定性好的算法

### *Example*

#### 例1

为减少舍入误差影响，应将$10-\sqrt{99}$改写为：$\dfrac{1}{10+\sqrt{99}}$。

## 范数

### 向量点积

- $\vec{x} = (x_1,x_2,\cdots,x_n)^T$
- $\vec{y} = (y_1,y_2,\cdots,y_n)^T$

$$\vec{x} \bullet \vec{y}
    = \sum_{i=1}^{n} x_iy_i
    = x_1y_1 + x_2y_2 + \cdots + x_ny_n
$$

**向量的模、向量的长度、向量的L2范数**

$$|\vec{x}| = \sqrt{ \vec{x} \bullet \vec{x} } = \sqrt{|x_1|^2 + |x_2|^2 + \cdots + |x_n|^2}$$

**性质**

- 当且仅当$\vec{x}=\vec{0}$时$\vec{x} \bullet \vec{x}=0$。
- $\vec{x} \bullet \vec{y} = \vec{y} \bullet \vec{x} =  y^T x = x^T y$
- $(α\vec{x}) \bullet \vec{y} = α(\vec{x} \bullet \vec{y})$
- $(\vec{x}_a + \vec{x}_b) \bullet \vec{y} = \vec{x}_a \bullet \vec{y} + \vec{x}_b \bullet \vec{y}$
- **柯西—施瓦茨不等式**：$|\vec{x} \bullet \vec{y}| ≤ |\vec{x}| ⋅ |\vec{y}|$
- **三角不等式**：$|\vec{x} + \vec{y}| ≤ |\vec{x}| + |\vec{y}|$

### 向量范数

| $L_0$ | $L_1$ | $L_2$ | $L_p, \,\,(p≥1)$ | $L_∞$ 
| - | - | - | - | - 
| $\|x\|_0$          | $\|x\|_1$                          | $\|x\|_2$、$\vert{x}\vert$            | $\|x\|_p$                                                    | $\|x\|_∞$
| 向量中非零元素的个数 | $$\sum_{i=1}^{n} \vert{x_i}\vert$$ | $$\sqrt{ \sum_{i=1}^{n} {x_i^2} }$$   | $$(\sum\limits_{i=1}^{n}{\vert{x_i}\vert}^p)^{\frac{1}{p}}$$ | $$\max\left\{\vert{x_1}\vert, \vert{x_2}\vert, \cdots. \vert{x_n}\vert\right\}$$
| | 曼哈顿范数 | 欧式范数 | | 切比雪夫范数

<!-- **向量范数的等价性定理**

设$\|x\|_s$、$\|x\|_t$为$R^n$上向量的任意两种范数，则存在常数$c_1, c_2 > 0$，使对一切$x∈R^n$有$c_1 \|x\|_s ≤ \|x\|_t ≤ c_2 \|x\|_s$（**该定理不能推广到无穷维空间**）。 -->

<!-- ![](dump/范数等价性证明.jpg) -->

### 矩阵范数

**算子范数（从属范数）**

设$x∈R^n$，$A∈R^{n×n}$，给出一种向量范数$\|x\|_{ν}$（eg：$ν=1,2,∞$），相对应地，定义一个矩阵的非负函数。

$$\|A\|_ν = \max_{x≠0} \dfrac{\|Ax\|_{ν}}{\|x\|_{ν}}$$

则$\|A\|_ν$满足矩阵范数的性质，称$\|A\|_ν$为**算子范数**。


| $\|A\|_1$  |  $\|A\|_2$ |  $\|A\|_∞$
| - | - | -
| $$\max\limits_{1≤j≤n} \sum\limits_{i=1}^{n} \vert{a_{ij}}\vert$$ | $$\sqrt{λ_{max} (A^TA)}$$ | $$\max\limits_{1≤i≤n} \sum\limits_{j=1}^{n} \vert{a_{ij}}\vert$$
| $A$的列范数 | $A$的2-范数 | $A$的行范数

**性质**

- $\|A\| ≥ 0$
- $\|cA\| = |c|⋅\|A\|$
- $\|A+B\| ≤ \|A\| + \|B\|$
- $\|AB\| ≤ \|A\|\|B\|$

### *Example*

#### 例1

$A=
    \left[\begin{array}{c}
       1  & -2
    \\ -3 & 4
    \end{array}\right]
$

- $\|A\|_1 = \max((1+3), (2+4))=6$
- $\|A\|_2 = \sqrt{15 + \sqrt{221}} ≈ 5.46$
- $\|A\|_∞ = \max((1+2), (3+4))=7$


## 谱

$A$的所有特征值的全体，称$A$的谱，记作$λ(A)$。

### 谱半径

$$ρ(A) = \max\limits_{1≤i≤n} |λ_i|$$

谱半径即包含所有特征值的圆的最小半径。

**性质**

- $ρ(A)≤\|A\|$（特征值上界）
- 若$A∈R^{n×n}$为对称矩阵，则$\|A\|_2 = ρ(A)$。
- 若$\|B\|<1$，则$I±B$为非奇异矩阵，且$\|(I±B)^{-1}\| ≤ \dfrac{1}{1-\|B\|}$

## 病态矩阵

### 病态矩阵

假设非奇异矩阵$A$，考虑$Ax=b$。如果矩阵$A$或常数项$b$的微小变化，引起方程组$Ax=b$解的巨大变化，则称此方程组为**病态方程组**，矩阵$A$为**病态矩阵**。否则称为**良态方程组**
、**良态矩阵**。

### 条件数

<!-- **定理1**

$Ax=b≠0$，且$A(x+δx)=b+δb$，则$\dfrac{\|δx\|}{\|x\|} ≤ \|A^{-1}\| ⋅ \|A\| ⋅ \dfrac{\|δb\|}{\|b\|}$。
即$δx$对常数项$b$的影响上界为$\|A^{-1}\| ⋅ \|A\|$。

**定理2**

$(A+δA)(x+δx)=b$，则$\|δx\| ≤ \dfrac{
        \|A^{-1}\| ⋅ \|δA\| ⋅ \|x\|
    }{
        1 - \|A^{-1}(δA)\|
    }$。

设$\|A^{-1}\| ⋅ \|δA\| < 1$，则$
    \dfrac{\|δA\|}{x} ≤ \dfrac{
        \|A^{-1}\| ⋅ \|A\| ⋅ \dfrac{\|δA\|}{A} 
    }{
        1 - \|A^{-1}\| ⋅ \|A\| ⋅ \dfrac{\|δA\|}{A} 
    }$。

**综上** -->

$\|A^{-1}\| ⋅ \|A\|$刻画了解对原始数据变化的灵敏程度，即方程组的病态程度。

称$cond(A)_v = \|A^{-1}\|_v ⋅ \|A\|_v$（eg：$v=1, 2, ∞$）为矩阵$A$的**条件数**。其中条件数越大，矩阵越病态。

**性质**

- 若$A$非奇异，则$cond(A)_v = \|A^{-1}\|_v ⋅ \|A\|_v ≥ \|A^{-1}⋅ A\|_v = 1$。
- $cond(cA)_v = cond(A)_v$
- 若$A$为正交矩阵（$A^{-1}=A^T$），则$cond(A)_2 = 1$
- 若$A$非奇异，且$R$正交，则$cond(RA)_2 = cond(AR)_2 = cond(A)_2$

### 谱条件数

- $cond(A)_2 = \|A^{-1}\|_2\|A\|_2 = \sqrt{ \dfrac{ λ_{max}(A^TA) }{ λ_{min}(A^TA) } }$
- 当$A$为对称矩阵时：$cond(A)_2 = \dfrac{ |λ_{max}| }{ |λ_{min}| }$，（$|λ_{max}|,|λ_{min}|$为绝对值最大和最小的特征值）

### 非条件数病态判别

矩阵病态的其它充分条件

- 矩阵元素间数量级差很大，且无一定规律。
- 矩阵行列式值相对来说很小。
- 列主元消去过程中，出现了量级很小的主元素。
- 数值求解过程中，计算解$x$的剩余向量$r=b-Ax$已经很小，但$x$仍不符合要求。

## 差商

- **一阶差商**：$f[x_0, x_k] = \dfrac{f(x_k)-f(x_0)}{x_k-x_0}$
- **二阶差商**：$f[x_0, x_1, x_k] = \dfrac{f[x_1, x_k]-f[x_0, x_1]}{x_k-x_0}$
- **$K$阶差商（均差）**：$f[x_0, \cdots, x_k] = \dfrac{f[x_1, \cdots, x_k]-f[x_0, \cdots, x_{k-1}]}{x_k-x_0}$

**性质**

- 差商的值与节点的排列次序无关
- 若$f(x)$为$n$次多项式，则$f[x_0,x_1,\cdots,x_n]$为一个常数，$f[x_0,x_1,\cdots,x_n,x_{n+1}] = 0$。
- $f[x_0, \cdots, x_k] = \sum\limits_{j=0}^{k} \dfrac{f(x_j)}{(x_j-x_0)\cdots(x_j-x_{j-1})(x_j-x_{j+1})(x_j-x_k)}$
- $f[x_0,\cdots,x_k] = \dfrac{f^{(k)}(ξ)}{k!}, \,\,\, ξ∈[a,b]$
